var data = [
  {
    "img": "DesperateHousewives.jpg",
    "names": "Desperate Housewives",
    "year": 2015,
    "genre": "Comedy",
    "director": "Dan Jukes",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "virgin_river.jpg",
    "names": "Virgin River",
    "year": 2022,
    "genre": "Family",
    "director": "Dan Jukes",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "Friends.jpg",
    "names": "Friends",
    "year": 2007,
    "genre": "Family",
    "director": "Jane Wilson",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "Grey's_Anatomy.jpg",
    "names": "Grey's Anatomy",
    "year": 2010,
    "genre": "Show",
    "director": "Jane Wilson",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"

    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "HouseCards.jpg",
    "names": "House of Cards",
    "year": 2019,
    "genre": "Show",
    "director": "Jane Wilson",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "young_sheldon.jpg",
    "names": "Young Sheldon",
    "year": 2020,
    "genre": "Comedy",
    "director": "Jane Wilson",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link": "https://www.youtube.com/watch?v=bd7UQA9laJE"
  },
  {
    "img": "spider-man-no-way-home.jpg",
    "names": "Spider-Man",
    "year": 2022,
    "genre": "Action",
    "director": "Jon Watts",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link":  "https://www.youtube.com/watch?v=JfVOs4VSpmA"
  },
{
    "img": "Black_Panther.jpg",
    "names": "Black Panther",
    "year": 2022,
    "genre": "Action",
    "director": "Ryan Coogler",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link":  "https://www.youtube.com/watch?v=4E2RNfQQImY"
  },
{
    "img": "john-wick-4.jpg",
    "names": "John Wick",
    "year": 2022,
    "genre": "Action",
    "director": "Chad Stahelski",
    "desc": [
      "Million tonne punch",
      "Damage resistance",
      "Superhuman reflexes"
    ],
    "link":  "https://www.youtube.com/watch?v=D-2KnLQFvsQ"
  },
{
    "img": "dont-look-up.jpg",
    "names": "Don't look up",
    "year": 2021,
    "genre": "Family",
    "director": "Adam McKay",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=RbIxYm3mKzI"
  },
{
    "img": "Red_Notice.jpg",
    "names": "Red Notice",
    "year": 2021,
    "genre": "Action",
    "director": "Rawson Marshall Thurber",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=Pj0wz7zu3Ms"
  },
{
    "img": "Halloween-Kills.jpg",
    "names": "Halloween Kills",
    "year": 2021,
    "genre": "Thriller",
    "director": "David Gordon Green",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=hL6R3HmQfPc"
  },
{
    "img": "orphan-first-kill.jpg",
    "names": "Orphan: First Kills",
    "year": 2022,
    "genre": "Thriller",
    "director": "William Brent Bell",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=_uX6of3vBu0"
  },
{
    "img": "beast.jpg",
    "names": "Beast",
    "year": 2022,
    "genre": "Thriller",
    "director": "Nelson Dilipkumar",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=oQMc7Sq36mI"
  },
{
    "img": "blonde.jpg",
    "names": "Blonde",
    "year": 2022,
    "genre": "Drama",
    "director": "Andrew Dominik",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=aIsFywuZPoQ"
  },
{
    "img": "bros.jpg",
    "names": "Bros",
    "year": 2022,
    "genre": "Comedy",
    "director": "Nocholas Stoller",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=BQIeBB9XMe8"
  },
{
    "img": "ticket-to-paradise.jpg",
    "names": "Ticket to Paradise",
    "year": 2022,
    "genre": "Family",
    "director": "OI Parker",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=hkP4tVTdsz8"
  },
{
    "img": "black-adam.jpg",
    "names": "Black Adam",
    "year": 2022,
    "genre": "Action",
    "director": "OI Parker",
    "desc": [
      "Radiation resistance",
      "Turning tiny",
      "Radiation blast"
    ],
    "link": "https://www.youtube.com/watch?v=X0tOpBuYasI"
  }
]

function showlist(res) {
  var tbody = document.querySelector("tbody");
  for (var i = 0; i < res.length; i++) {
    var obj = res[i];
    var tr = document.createElement('tr');
    //the 1st column show the picture of the video
    var tdpic = document.createElement('img');
    tdpic.setAttribute("name", obj.names);
    tdpic.setAttribute("src", "images/" + obj.img);
    tdpic.setAttribute("onclick", "clickImage");
    tdpic.onclick = function () {
      window.location.assign(obj.link);
    }
    tr.appendChild(tdpic);
    //the 2nd column show the name of the movies
    var tdname = document.createElement('td');
    tdname.innerHTML = `${obj.names}`;
    tr.appendChild(tdname);
    //show the year of the movies
    var tdyear = document.createElement('td');
    tdyear.innerHTML = `${obj.year}`;
    tr.appendChild(tdyear);
    //the 3rd column show the Genre
    var tdDesc = document.createElement('td');
    tdDesc.innerHTML = `${obj.desc}`;
    tr.appendChild(tdDesc);

    //finish one row and add it to tbody
    tbody.appendChild(tr);
  }
}


function searchfunc() {
  var input = document.getElementById('searchbar').value;
  var original_input = input;
  console.log("=====" + input);
  if (input != "") {
    var tbody = document.querySelector("tbody");
    tbody.innerHTML = '';
    input = input.toLowerCase();
    var arr = [];
    for (var i = 0; i < data.length; i++) {
      var obj = data[i];
      //if exist, create the table data:column and row
      if (obj.names.toLowerCase().includes(input) || ((obj.desc).indexOf(input) > -1)) {
        arr.push(obj);
      }
    }
    showlist(arr);
    document.getElementById('searchbar').value=original_input;
  }
}

function getOption(selectObject) {
  //set the value of item
  var value = document.getElementById('filter').value.toLowerCase();
  var keyvalue = document.getElementById('searchbar').value.toLowerCase();
  // create the search result first, then filter items  
  var flagsSearch = false;
  var flagFilter = false;
  var arr = [];
  var tbody = document.querySelector("tbody");
  tbody.innerHTML = '';
  for (var i = 0; i < data.length; i++) {
    var obj = data[i];
    flagsSearch = obj.names.toLowerCase().includes(keyvalue);
    flagFilter = obj.genre.toLowerCase().includes(value);
    if (flagsSearch && flagFilter) {
      arr.push(obj);
    }
  }
  showlist(arr);
}

//parse the request and get the search value
function oneValues() {
  var oneValue;
  var url = window.location.search;

  if (url.indexOf("?") != -1) {
    oneValue = url.substring(url.indexOf("=") + 1);
    oneValue = oneValue.split("&")[0];
  }
  return oneValue;
}


function getRequest() {
  var searchword = oneValues();
  document.getElementById("searchbar").value = searchword;
  if (searchword.includes("?")) {
    
  }
  searchfunc();
  
}

getRequest();